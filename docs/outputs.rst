Generated outputs
=================

Oktoberfest creates a variety of files and groups them within the user defined output directory. The following tables provide an overview of all subdirectories and files created depending on the job that is executed.

General directory structure
---------------------------

.. table::
    :class: fixed-table

    +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Directory             | Description                                                                                                                                                                                                                                                                                                                                                                                                                   |
    +=======================+===============================================================================================================================================================================================================================================================================================================================================================================================================================+
    | data/                 | Contains hdf5 files that combine search results, annotated spectra, metadata in <spectra_file>.mzML.hdf5 and predictions in <spectra_file>.mzML.pred.hdf5 where <spectra_file> is replaced with the specific name of the RAW file for which information is stored. The files are updated and store the progress of the current job and enable skipping specific steps when rerunning a job.                                   |
    +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | data/dlomix           | Contains spectra processed for usage in machine learning applications with DLomix: preprocessed datasets in Parquet format, as well as lists of ion types and modifications in them in plain text format.                                                                                                                                                                                                                     |
    +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | msms/                 | Contains combined msms.prosit and separated search results in <spectra_file>.prosit where <spectra_file> is replaced with the spectra file name for which search results are stored. The files are stored in the `internal format <./internal_format.html>`_  and are created as part of preprocessing search results from supported search engines. If a file is present, preprocessing is skipped when rerunning a job.     |
    +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | spectra/              | Contains spectra files in mzML / hdf format (<spectra_file>.[mzML,hdf] where <spectra_file> is replaced with the specific name of the RAW file / .d folder that was converted). If spectra are provided in mzML / hdf format already, they will not show up in this folder and conversion is skipped when (re)running a job.                                                                                                  |
    +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | proc/                 | Contains information on successful job steps in <job_step>.done where <job_step> is replaced by the specfic job step completed. If a file is present, the specific step will be skipped when rerunning a job.                                                                                                                                                                                                                 |
    +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | results/              | Contains all results of a specific job. See below results table for an overview of all files stored in this directory.                                                                                                                                                                                                                                                                                                        |
    +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | results/mokapot/      | Subdirectory in results/ containing all inputs for running percolator / mokapot (depending on which is used) and the corresponding results and summary plots. See below percolator / mokapot table for details on the files in this directory.                                                                                                                                                                                |
    | results/percolator/   |                                                                                                                                                                                                                                                                                                                                                                                                                               |
    +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Files in the results directory
------------------------------

.. table::
    :class: fixed-table

    +---------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | File                                  | Description                                                                                                                                                                                  |
    +=======================================+==============================================================================================================================================================================================+
    | <spectra_file>_ce.txt                 | Contains the best collision energy according to the collision energy calibration where <spectra_file> is replaced with the name of the spectra file for which the calibration was performed  |
    +---------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | predicted_library.<csv|msp|dlib>      | Contains the spectral library in either spectronaut, msp, or dlib format depending on what format was chosen in the configuration file                                                       |
    +---------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | peptides_internal.csv                 | Contains the peptide list including metadata needed for spectral library generation when providing a fasta file for in-silico digestion or a peptides list                                   |
    +---------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


Files in the mokapot / percolator directory
-------------------------------------------

This section details the files located within the mokapot / percolator directroy. In below file names, <method> is replaced with either percolator or mokapot depending on which method was used for target / decoy separation and FDR estimation.

.. table::
    :class: fixed-table

    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | File                                  | Description                                                                                                                                                                                 |
    +=======================================+=============================================================================================================================================================================================+
    | rescore.tab                           | Input file for percolator / mokapot containing the features from peptide property prediction (see `features for target / decoy separation <./svm_features.html>`_)                          |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | <spectra_file>.rescore.tab            | Input file for percolator / mokapot containing the features from peptide property prediction for a spectra file name that replaces <spectra_file> (files are concatenated into rescore.tab) |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | rescore.<method>.peptides.txt         | Percolator / mokapot output for target peptides (features from peptide property prediction)                                                                                                 |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | rescore.<method>.psms.txt             | Percolator / mokapot output for target PSMs (features from peptide property prediction)                                                                                                     |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | rescore.<method>.decoy.peptides.txt   | Percolator / mokapot output for decoy peptides (features from peptide property prediction)                                                                                                  |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | rescore.<method>.decoy.psms.txt       | Percolator / mokapot output for decoy PSMs (features from peptide property prediction)                                                                                                      |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | rescore.percolator.weights.csv        | Percolator output about individual feature weights (features from peptide property prediction, percolator only)                                                                             |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | rescore.log                           | Log output from percolator / mokapot (features from peptide property prediction)                                                                                                            |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | original.tab                          | Input file for percolator / mokapot containing only the original features (see `features for target / decoy separation <./svm_features.html>`_)                                             |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | <spectra_file>.original.tab           | Input file for percolator / mokapot containing only the original features for a spectra file name that replaces <spectra_file> (files are concatenated into original.tab)                   |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | original.<method>.peptides.txt        | Percolator / mokapot output for target peptides (original features)                                                                                                                         |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | original.<method>.psms.txt            | Percolator / mokapot output for target PSMs (original features)                                                                                                                             |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | original.<method>.decoy.peptides.txt  | Percolator / mokapot output for decoy peptides (original features)                                                                                                                          |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | original.<method>.decoy.psms.txt      | Percolator / mokapot output for decoy PSMs (original features)                                                                                                                              |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | original.percolator.weights.csv       | Percolator output about individual feature weights (original features, percolator only)                                                                                                     |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | original.log                          | Log output from percolator / mokapot (original features)                                                                                                                                    |
    +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

The following output files are specific to XL‑MS rescoring.

.. table::
    :class: fixed-table

    +---------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | File                                  | Description                                                                                                                                                                                                                                              |
    +=======================================+==========================================================================================================================================================================================================================================================+
    | percolator_xifdr_input.csv            | Contains Percolator scores for each CSM (cross‑linked spectrum match). Oktoberfest does **not** perform FDR estimation for XL‑MS data — this file can be uploaded directly to `xiFDR <https://github.com/Rappsilber-Laboratory/xiFDR>`_ to estimate FDR. |
    +---------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | xisearch_xifdr_input.csv              | Contains XiSearch scores for each CSM. You can feed this file to xiFDR as well, allowing a direct comparison between original XiSearch scores and rescored (Percolator) results.                                                                         |
    +---------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+